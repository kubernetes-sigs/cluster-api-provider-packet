---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.14.0
  name: packetmachinetemplates.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: PacketMachineTemplate
    listKind: PacketMachineTemplateList
    plural: packetmachinetemplates
    shortNames:
    - pmt
    singular: packetmachinetemplate
  scope: Namespaced
  versions:
  - name: v1beta1
    schema:
      openAPIV3Schema:
        description: PacketMachineTemplate is the Schema for the packetmachinetemplates
          API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: PacketMachineTemplateSpec defines the desired state of PacketMachineTemplate.
            properties:
              template:
                description: PacketMachineTemplateResource describes the data needed
                  to create am PacketMachine from a template.
                properties:
                  spec:
                    description: Spec is the specification of the desired behavior
                      of the machine.
                    properties:
                      billingCycle:
                        description: DeviceCreateInputBillingCycle The billing cycle
                          of the device.
                        type: string
                      facility:
                        description: |-
                          Facility represents the Packet facility for this machine.
                          Override from the PacketCluster spec.
                        type: string
                      hardwareReservationID:
                        description: |-
                          HardwareReservationID is the unique device hardware reservation ID, a comma separated list of
                          hardware reservation IDs, or `next-available` to automatically let the Packet api determine one.
                        type: string
                      ipxeURL:
                        description: |-
                          IPXEUrl can be used to set the pxe boot url when using custom OSes with this provider.
                          Note that OS should also be set to "custom_ipxe" if using this value.
                        type: string
                      machineType:
                        type: string
                      metro:
                        description: |-
                          Metro represents the Packet metro for this machine
                          Override from the PacketCluster spec.
                        type: string
                      os:
                        type: string
                      ports:
                        description: NetworkPorts is an optional set of configurations
                          for configuring layer2 seetings in a machine.
                        items:
                          description: 'Port defines the Layer2(VLAN) Configuration
                            that needs to be done on a port (eg: bond0).'
                          properties:
                            bonded:
                              description: port bonded or not.
                              type: boolean
                            layer2:
                              description: convert port to layer 2. is false by default
                                on new devices. changes result in /ports/id/convert/layer-[2|3]
                                API calls
                              type: boolean
                            name:
                              description: name of the port e.g bond0,eth0 and eth1
                                for 2 NIC servers.
                              type: string
                            networks:
                              description: Network configurations for the port
                              items:
                                description: Network defines the network configuration
                                  for a port.
                                properties:
                                  addressFromPool:
                                    description: |-
                                      AddressFromPool is a reference of IPAddressPool that should be assigned to IPAddressClaim.
                                      The machine's cloud-init metadata will be populated with IPAddresse fulfilled by an IPAM provider.
                                    properties:
                                      apiGroup:
                                        description: |-
                                          APIGroup is the group for the resource being referenced.
                                          If APIGroup is not specified, the specified Kind must be in the core API group.
                                          For any other third-party types, APIGroup is required.
                                        type: string
                                      kind:
                                        description: Kind is the type of resource
                                          being referenced
                                        type: string
                                      name:
                                        description: Name is the name of resource
                                          being referenced
                                        type: string
                                    required:
                                    - kind
                                    - name
                                    type: object
                                    x-kubernetes-map-type: atomic
                                  addressType:
                                    description: |-
                                      AddressType is the type of address to assign to the machine. It can be either Internal or External.
                                      kubebuilder:validation:Enum=Internal;External
                                    type: string
                                  netmask:
                                    description: |-
                                      Netmask is the netmask for the network.
                                      eg: 255.255.255.248
                                    type: string
                                  routes:
                                    description: List of Routes to be configured on
                                      the Packet Machine
                                    items:
                                      description: RouteSpec defines the static route
                                        configuration for a PacketMachine.
                                      properties:
                                        destination:
                                          type: string
                                        gateway:
                                          type: string
                                      required:
                                      - destination
                                      - gateway
                                      type: object
                                    type: array
                                  vlanID:
                                    description: VLAN ID for the VLAN created on the
                                      EM Console
                                    type: string
                                  vxlan:
                                    description: VLANs for EM API to find by vxlan,
                                      project, and metro match then attach to device.
                                      OS userdata template will also configure this
                                      VLAN on the bond device
                                    type: integer
                                type: object
                              type: array
                          required:
                          - name
                          - networks
                          type: object
                        type: array
                      providerID:
                        description: ProviderID is the unique identifier as specified
                          by the cloud provider.
                        type: string
                      sshKeys:
                        items:
                          type: string
                        type: array
                      tags:
                        description: Tags is an optional set of tags to add to Packet
                          resources managed by the Packet provider.
                        items:
                          type: string
                        type: array
                    required:
                    - machineType
                    - os
                    type: object
                required:
                - spec
                type: object
            required:
            - template
            type: object
        type: object
    served: true
    storage: true
